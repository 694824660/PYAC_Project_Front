{"remainingRequest":"D:\\Vue_study\\pyac_project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Vue_study\\pyac_project\\src\\views\\post\\Edit.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\Vue_study\\pyac_project\\src\\views\\post\\Edit.vue","mtime":1619436083201},{"path":"D:\\Vue_study\\pyac_project\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\Vue_study\\pyac_project\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Vue_study\\pyac_project\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Vue_study\\pyac_project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Vue_study\\pyac_project\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.vditor-reset pre > code {\r\n  font-size: 100%;\r\n}\r\n",{"version":3,"sources":["Edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;AACA;AACA","file":"Edit.vue","sourceRoot":"src/views/post","sourcesContent":["<template>\r\n  <section>\r\n    <div class=\"columns\">\r\n      <div class=\"column is-full\">\r\n        <el-card class=\"box-card\" shadow=\"never\">\r\n          <div slot=\"header\" class=\"clearfix\">\r\n            <span><i class=\"fa fa fa-book\"> 主题 / 更新主题</i></span>\r\n          </div>\r\n          <div>\r\n            <el-form :model=\"topic\" ref=\"topic\" class=\"demo-topic\">\r\n              <el-form-item prop=\"title\">\r\n                <el-input\r\n                  v-model=\"topic.title\"\r\n                  placeholder=\"输入新的主题名称\"\r\n                ></el-input>\r\n              </el-form-item>\r\n\r\n              <!--Markdown-->\r\n              <div id=\"vditor\"></div>\r\n\r\n              <b-taginput\r\n                v-model=\"tags\"\r\n                class=\"my-3\"\r\n                maxlength=\"15\"\r\n                maxtags=\"3\"\r\n                ellipsis\r\n                placeholder=\"请输入主题标签，限制为 15 个字符和 3 个标签\"\r\n              />\r\n              <el-form-item class=\"mt-3\">\r\n                <el-button type=\"primary\" @click=\"handleUpdate()\"\r\n                  >更新\r\n                </el-button>\r\n                <el-button @click=\"resetForm('topic')\">重置</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </el-card>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport { getTopic, update } from \"@/api/post\";\r\nimport Vditor from \"vditor\";\r\nimport \"vditor/dist/index.css\";\r\nexport default {\r\n  name: \"TopicEdit\",\r\n  components: {},\r\n  data() {\r\n    return {\r\n      topic: {},\r\n      tags: [],\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchTopic();\r\n  },\r\n  methods: {\r\n    renderMarkdown(md) {\r\n      this.contentEditor = new Vditor(\"vditor\", {\r\n        height: 460,\r\n        placeholder: \"输入要更新的内容\",\r\n        preview: {\r\n          hljs: { style: \"monokai\" },\r\n        },\r\n        mode: \"sv\",\r\n        after: () => {\r\n          this.contentEditor.setValue(md);\r\n        },\r\n      });\r\n    },\r\n    fetchTopic() {\r\n      getTopic(this.$route.params.id).then((value) => {\r\n        this.topic = value.data.topic;\r\n        this.tags = value.data.tags.map(tag => tag.name);\r\n        this.renderMarkdown(this.topic.content);\r\n      });\r\n    },\r\n    handleUpdate: function () {\r\n      this.topic.content = this.contentEditor.getValue();\r\n      update(this.topic).then((response) => {\r\n        const { data } = response;\r\n        console.log(data);\r\n        setTimeout(() => {\r\n          this.$router.push({\r\n            name: \"post-detail\",\r\n            params: { id: data.id },\r\n          });\r\n        }, 800);\r\n      });\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n      this.contentEditor.setValue(\"\");\r\n      this.tags = \"\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.vditor-reset pre > code {\r\n  font-size: 100%;\r\n}\r\n</style>"]}]}